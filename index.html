<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biểu đồ cột từ Excel</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>

    <h1>Biểu đồ cột từ Excel</h1>
    <div class="chart-container" id="chartContainer">
        <!-- Các thanh sẽ được tạo ra ở đây -->
    </div>

    <script>
        // Đọc tệp Excel có sẵn
        fetch('data.xlsx') // Đường dẫn tới tệp Excel
            .then(response => response.arrayBuffer())
            .then(data => {
                const workbook = XLSX.read(data, { type: 'array' });
                
                // Giả sử dữ liệu nằm trong sheet đầu tiên
                const firstSheetName = workbook.SheetNames[0];
                const worksheet = workbook.Sheets[firstSheetName];

                // Chuyển đổi dữ liệu sang JSON
                const json = XLSX.utils.sheet_to_json(worksheet);
                createChart(json);
            })
            .catch(error => console.error('Error fetching the Excel file:', error));

        function createChart(data) {
            const chartContainer = document.getElementById('chartContainer');
            chartContainer.innerHTML = ''; // Xóa nội dung cũ

            data.forEach(row => {
                const value = row.Value; // Thay đổi 'Value' nếu tiêu đề cột trong Excel khác
                if (value) {
                    const bar = document.createElement('div');
                    bar.className = 'bar';
                    bar.style.height = `${value}%`; // Chiều cao dựa trên giá trị
                    bar.innerHTML = `<span>${value}%</span>`;
                    chartContainer.appendChild(bar);
                }
            });
        }
    </script>

</body>
</html>
